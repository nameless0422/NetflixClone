<div class="new-page-container">
  <!-- 뷰 전환 버튼 -->
  <div class="view-toggle">
    <button (click)="toggleView()">
      {{ isListView ? '테이블 보기' : '리스트 보기' }}
    </button>
  </div>

  <!-- 영화 카드 컨테이너 -->
  <div [class.grid-view]="!isListView" [class.list-view]="isListView">
    <div class="movie-card" 
        *ngFor="let movie of (isListView ? movies : currentMovies)" 
        (click)="openMovieDetail(movie)"
        (mouseenter)="onMouseEnter(movie.id)"
        (mouseleave)="onMouseLeave()">
      <img
        [src]="'https://image.tmdb.org/t/p/w500' + movie.poster_path"
        [alt]="movie.original_title"
        class="movie-img"
      />
      <div class="movie-info">
        <h3>{{ movie.title }}</h3>
        <p>{{ movie.overview | slice:0:50 }}...</p>
      </div>
      <div class="rating-circle" *ngIf="hoveredMovieId === movie.id">
        <div class="circle">
          <svg viewBox="0 0 36 36" class="circular-chart">
            <path class="circle-bg"
              d="M18 2.0845
                a 15.9155 15.9155 0 0 1 0 31.831
                a 15.9155 15.9155 0 0 1 0 -31.831"
            />
            <path class="circle-progress"
              [attr.stroke-dasharray]="getScoreDashArray(movie.vote_average * 10) + ', 100'"
              d="M18 2.0845
                a 15.9155 15.9155 0 0 1 0 31.831
                a 15.9155 15.9155 0 0 1 0 -31.831"
            />
          </svg>
          <span class="percentage">{{ (movie.vote_average * 10) | number:'1.0-0' }}%</span>
        </div>
      </div>
    </div>
  </div>

  <!-- 테이블 보기에서 페이지네이션 -->
  <div *ngIf="!isListView" class="pagination">
    <button (click)="goToPreviousPage()" [disabled]="currentPage === 1">이전</button>
    <span>{{ currentPage }}</span>
    <button (click)="goToNextPage()">다음</button>
  </div>

  <!-- 맨 위로 버튼 -->
  <button *ngIf="showScrollToTop" class="scroll-to-top" (click)="scrollToTop()">▲ 맨 위로</button>

  <!-- 선택된 영화 모달 -->
  <app-movie-detail 
    *ngIf="selectedMovieId" 
    [movieId]="selectedMovieId" 
    (close)="closeMovieDetail()"
  ></app-movie-detail>
</div>
